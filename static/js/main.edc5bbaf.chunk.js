(this.webpackJsonpchatclientv2=this.webpackJsonpchatclientv2||[]).push([[0],{91:function(e,n,t){},97:function(e,n,t){},98:function(e,n,t){},99:function(e,n,t){"use strict";t.r(n);var c,a,r,s=t(1),o=t(0),i=t(51),l=t.n(i),u=t(4),j=t(17),b=t(2),m=t(15),d=t.n(m),h=(t(91),function(e){var n=Object(o.useState)(""),t=Object(u.a)(n,2),r=t[0],i=t[1],l=Object(o.useState)(""),j=Object(u.a)(l,2),m=j[0],h=j[1],O=Object(o.useState)([]),v=Object(u.a)(O,2),f=v[0],x=v[1],p=Object(o.useState)(""),g=Object(u.a)(p,2),k=g[0],y=g[1],N=Object(o.useState)([]),S=Object(u.a)(N,2),w=S[0],C=S[1],I=Object(b.e)(),P=function(e){e.preventDefault(),a.emit("fromclient","hello"),a.close(),e.returnValue="hello"};Object(o.useEffect)((function(){return window.addEventListener("beforeunload",P),e.serverIP&&(c=d.a.connect(e.serverIP)).on("connect",(function(){console.log("Server connected"),y(!0),c.emit("enterLobby",{},(function(e){x(e)})),c.on("roomsUpdate",(function(e){x(e)}))})),function(){c&&(console.log("closing socket on unmount"),c.close())}}),[]),Object(o.useEffect)((function(){return console.log("querysocket mount"),(a=d()("https://chatquery.herokuapp.com")).on("connect",(function(){console.log("Connected to query server"),a.emit("fromclient","hello"),a.emit("getservers",(function(e){console.log(e),C(e)})),a.on("srvupdate",(function(e){console.log(e),C(e)}))})),function(){a.close(),console.log("querysocket unmount"),window.removeEventListener("beforeunload",P)}}),[]);var E=function(){(c=d.a.connect(e.serverIP)).on("connect",(function(){y(!0),c.emit("enterLobby",{},(function(e){x(e)})),c.on("roomsUpdate",(function(e){x(e)}))}))};return k?Object(s.jsx)("div",{className:"joinContainer",children:Object(s.jsxs)("div",{className:"container",children:[Object(s.jsxs)("div",{className:"box namebox",children:[Object(s.jsx)("h1",{style:{marginBottom:"0.5em"},children:"Selamat Datang"}),Object(s.jsx)("p",{style:{marginBottom:"1em"},children:" Masukkan username dan room yang ingin anda gabung"}),Object(s.jsx)("input",{type:"text",name:"username",value:r,placeholder:"username",onChange:function(e){var n=e.target.value;return i(n.replaceAll(" ","_").substring(0,32))}}),Object(s.jsx)("br",{}),Object(s.jsx)("input",{type:"text",name:"roomname",value:m,placeholder:"room",onChange:function(e){var n=e.target.value;return h(n.replaceAll(" ","_").substring(0,32))}}),Object(s.jsx)("br",{}),Object(s.jsx)("button",{onClick:function(e){e.preventDefault(),r&&m?c.emit("getUsers",(function(e){console.log(r);var n=e.find((function(e){return e.name===r}),1);n?alert("Username "+n.name+" sedang dipakai di room "+n.room):(c.emit("leaveLobby"),c.disconnect(),I.push("/chat?name=".concat(r,"&room=").concat(m)))})):alert("Masukkan username dan roomname")},children:"Join"})]}),Object(s.jsxs)("div",{className:"box roombox",children:[Object(s.jsx)("p",{children:" Room yang dibuat pengguna (silahkan klik/tap nama room dibawah ini untuk join room yang sudah ada) : "}),Object(s.jsx)("ul",{children:f.map((function(e,n){return Object(s.jsxs)("li",{onClick:function(){return h(e.name)},children:[e.name," - ",e.users," users"]},n)}))})]})]})}):Object(s.jsx)("div",{className:"joinContainer",style:{height:"100%"},children:Object(s.jsxs)("div",{className:"container",children:[Object(s.jsxs)("div",{className:"box",children:[Object(s.jsx)("h1",{children:"Wei laju"}),Object(s.jsx)("p",{style:{marginBottom:"25px",marginTop:"12px"},children:"Masukkan IP server"}),Object(s.jsxs)("div",{style:{display:"flex"},children:[Object(s.jsx)("input",{type:"text",name:"serverip",value:e.serverIP,onChange:function(n){var t=n.target.value;return e.setServerIP(t.replaceAll(" ","."))},style:{width:"100%",marginRight:"10px"},onKeyDown:function(e){return"Enter"===e.key?E():null}}),Object(s.jsx)("button",{onClick:function(){return E()},children:"Connect"})]})]}),Object(s.jsxs)("div",{className:"box servers",children:[Object(s.jsx)("p",{children:"Ato pilih dari salah satu server yang berjalan ini"}),Object(s.jsx)("ul",{children:w.map((function(n,t){return Object(s.jsxs)("li",{onClick:function(){return e.setServerIP(n[1])},children:[n[0]," - ",n[1]]},t)}))})]})]})})}),O=t(54),v=t(53),f=t.n(v),x=(t(97),function(e){var n=Object(o.useState)(""),t=Object(u.a)(n,2),c=t[0],a=t[1],i=Object(o.useState)(""),l=Object(u.a)(i,2),j=l[0],m=l[1],h=Object(o.useState)(""),v=Object(u.a)(h,2),x=v[0],p=v[1],g=Object(o.useState)([]),k=Object(u.a)(g,2),y=k[0],N=k[1],S=Object(o.useState)(""),w=Object(u.a)(S,2),C=w[0],I=w[1],P=Object(o.useRef)(null),E=Object(b.e)(),D=Object(o.useState)(""),L=Object(u.a)(D,2),M=L[0],R=L[1];Object(o.useEffect)((function(){var n=f.a.parse(window.location.search),t=n.name,c=n.room;if(a(t),m(c),e.serverIP)return(r=d.a.connect(e.serverIP)).emit("enterRoom",{name:t,room:c},(function(e){"CONNECTED"!==e.srvinfo.split(" ")[0]&&I(e.srvinfo)})),r.on("broadcastMessage",(function(e){N((function(n){return[].concat(Object(O.a)(n),[e])}))})),function(){C||r.emit("leaveRoom",{name:t,room:c})};E.push("/")}),[]),Object(o.useEffect)((function(){M&&P.current.scrollIntoView({behavior:"smooth"})}),[y]);var U=function(){r.emit("userMessage",{username:c,roomname:j,usermessage:x}),p("")};return C?Object(s.jsx)("div",{children:Object(s.jsx)("div",{children:Object(s.jsxs)("p",{children:[" Username sedang dipakai dan berada di room `",C.split(" ")[1],"`",Object(s.jsx)("br",{}),Object(s.jsx)("br",{}),"jika anda merasa ini merupakan kesalahan server, sorry bro, server tidak",Object(s.jsx)("br",{}),"pernah salah,, wkwkwk just kidding, coba close ini tab kong akses ulang",Object(s.jsx)("br",{})]})})}):Object(s.jsx)("div",{className:"chatContainer",children:Object(s.jsxs)("div",{className:"box",children:[Object(s.jsxs)("div",{className:"header",children:[Object(s.jsx)("h1",{children:j}),Object(s.jsx)("p",{children:c})]}),Object(s.jsxs)("div",{className:"chatbox",onScroll:function(e){var n=e.target.scrollHeight-e.target.scrollTop>e.target.clientHeight-50;R(!!n)},children:[y.map((function(e,n){return Object(s.jsxs)("div",{className:"chatbubble "+(e.name!==c?"they":"mine"),children:[Object(s.jsx)("p",{className:"name",style:{display:y[n-1]&&y[n-1].name===e.name?"none":null},children:e.name}),Object(s.jsx)("p",{className:"message",children:e.message})]},n)})),Object(s.jsx)("div",{style:{display:"hidden"},ref:P})]}),Object(s.jsxs)("div",{className:"chatinput",children:[Object(s.jsx)("input",{type:"text",value:x,onChange:function(e){var n=e.target.value;return p(n.substring(0,1024))},onKeyDown:function(e){return"Enter"===e.key&&x.length>0?U():null}}),Object(s.jsx)("button",{onClick:function(){return x.length>0?U():null},children:"\xbb"})]})]})})}),p=function(){var e=Object(o.useState)(""),n=Object(u.a)(e,2),t=n[0],c=n[1];return Object(s.jsxs)(j.a,{basename:"/chatroom",children:[Object(s.jsx)(b.a,{path:"/",exact:!0,render:function(){return Object(s.jsx)(h,{serverIP:t,setServerIP:c})}}),Object(s.jsx)(b.a,{path:"/chat",render:function(){return Object(s.jsx)(x,{serverIP:t})}})]})};t(98);l.a.render(Object(s.jsx)(p,{}),document.getElementById("root"))}},[[99,1,2]]]);